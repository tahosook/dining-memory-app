# 食事写真記録アプリ - 技術仕様書

## プロジェクト概要
食べたご飯・飲んだお酒の写真をAIで解析し、テキスト化してセマンティック検索可能な記録アプリ

### ターゲット
- 40代後半男性
- 技術リテラシー高
- シンプルなUIを求める
- ダイエット意識あり

## 技術スタック選定（無料枠重視）

### フロントエンド
**選択: Next.js 14 (App Router) + TypeScript**
- 理由:
  - AI支援が豊富（Cursor, Copilotで高い生産性）
  - モバイル対応が容易（PWA化可能）
  - 画像最適化機能内蔵
  - デプロイが簡単（Vercel）
- **無料枠**: 開発・ビルドは完全無料

### バックエンド
**選択: Next.js API Routes**
- 理由:
  - フロントエンドと統合、開発・デプロイが簡単
  - サーバーレス環境で運用コスト低
  - TypeScriptで一貫した開発
- **無料枠**: Vercel Hobbyプランで十分

### データベース
**選択: Supabase (PostgreSQL)**
- 理由:
  - 簡単セットアップ
  - リアルタイム機能
  - 画像ストレージ機能内蔵
  - ベクトル検索対応（将来のセマンティック検索用）
  - 認証機能付き
- **無料枠**: 500MB DB + 1GB ストレージ + 50MB ファイルアップロード

### AI画像解析
**選択: Google Gemini API (Free Tier) + OpenAI API ($5クレジット)**
- 理由:
  - Gemini: 月15リクエスト/分まで無料、画像解析対応
  - OpenAI: 新規アカウントで$5無料クレジット
  - フォールバック戦略で可用性確保
- **無料枠**: 
  - Gemini: 月1,500リクエスト無料
  - OpenAI: $5分（約500-1000画像解析）

### 認証
**選択: Supabase Auth**
- 理由:
  - データベースと統合
  - ソーシャルログイン対応
  - 設定が簡単
- **無料枠**: 50,000 月間アクティブユーザーまで無料

### デプロイ・ホスティング
**選択: Vercel (Hobby Plan)**
- 理由:
  - Next.jsとの親和性
  - 自動デプロイ
  - 環境変数管理が容易
- **無料枠**: 100GB帯域幅/月、独自ドメイン対応

### 画像ストレージ
**選択: Supabase Storage**
- 理由:
  - データベースと統合
  - CDN機能付き
  - 画像変換機能
- **無料枠**: 1GB + 2GB帯域幅/月
- **補完策**: 必要に応じてCloudinary（月25クレジット無料）

## 無料枠での運用コスト試算

### 月間想定（個人利用）
- **写真解析**: 50枚/月
- **データベース**: 食事記録500件程度
- **画像ストレージ**: 100MB/月
- **サイト訪問**: 1,000PV/月

### サービス別コスト
| サービス | 無料枠 | 想定使用量 | コスト |
|---------|--------|------------|--------|
| Vercel | 100GB帯域幅 | ~1GB | **無料** |
| Supabase | 500MB DB + 1GB Storage | 50MB + 100MB | **無料** |
| Google Gemini | 1,500req/月 | 50req/月 | **無料** |
| OpenAI | $5クレジット | フォールバック用 | **無料** |
| Cloudinary | 25クレジット | 必要時のみ | **無料** |

**合計月額: 0円** 🎉

### 無料枠を超えた場合の移行戦略
1. **画像ストレージ**: Cloudinary無料枠 → R2/S3互換ストレージ
2. **AI解析**: 使用量に応じてOpenAI従量課金
3. **データベース**: Supabase Pro ($25/月)
4. **ホスティング**: Vercel Pro ($20/月)

### 開発・デプロイコスト
- **ドメイン**: Vercel提供サブドメイン（無料）
- **SSL証明書**: 自動提供（無料）
- **CI/CD**: GitHub Actions（月2,000分無料）
- **開発ツール**: Cursor（個人無料版）/ VS Code（無料）

## 開発環境
- **IDE**: Cursor (AI支援重視)
- **バージョン管理**: GitHub
- **パッケージ管理**: pnpm
- **CSS**: Tailwind CSS
- **UI コンポーネント**: shadcn/ui

## MVP機能仕様

### 必須機能
1. **写真撮影・アップロード**
   - カメラ連携
   - ファイル選択
   - 画像プレビュー

2. **AI解析・保存**
   - OpenAI Vision APIで解析
   - 料理名、材料、メモを抽出
   - Supabaseに保存

3. **記録一覧表示**
   - 日付別表示
   - サムネイル表示
   - 解析結果表示

4. **基本検索**
   - テキスト検索
   - 日付フィルター

### 将来拡張機能
- セマンティック検索（ベクトル検索）
- 栄養素情報表示
- 統計・レポート機能
- 位置情報連携

## 次のステップ
1. 環境セットアップ
2. データベース設計
3. 画面設計・ワイヤーフレーム
4. API設計