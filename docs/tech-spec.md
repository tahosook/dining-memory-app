# 食事写真記録アプリ - 技術仕様書

## プロジェクト概要
食べたご飯・飲んだお酒の写真をAIで解析し、テキスト化してセマンティック検索可能な記録アプリ

### ターゲット
- 40代後半男性
- 技術リテラシー高
- シンプルなUIを求める
- ダイエット意識あり

## 技術スタック選定（ネイティブアプリ + 端末リソース最大活用）

### アプリ開発フレームワーク
**選択: React Native + Expo**
- 理由:
  - iOS/Android両対応でワンコードベース
  - 豊富なネイティブ機能アクセス
  - AI開発支援（Cursor/Copilot）が充実
  - 無料でApp Store/Google Play配布可能
- **端末活用**: ネイティブAPI、GPU、ストレージ直接アクセス

### ローカルデータベース
**選択: SQLite + Watermelon DB**
- 理由:
  - 高性能なローカルSQL DB
  - 大容量データ処理（GB級も可能）
  - 複雑クエリ、インデックス対応
  - オフライン完全対応、暗号化対応
- **端末活用**: 端末内蔵SQLiteエンジンを直接活用

### ローカルストレージ・ファイル管理
**選択: React Native File System + 端末内蔵ストレージ**
- 理由:
  - 端末の内部ストレージ直接アクセス
  - ファイル操作、圧縮、メタデータ管理
  - アプリ専用領域で高セキュリティ
  - iCloud/Google Drive自動バックアップ対応
- **端末活用**: 端末の全ストレージ容量を活用可能

### カメラ・画像処理
**選択: Expo Camera + React Native Image Resizer**
- 理由:
  - ネイティブカメラアプリ並みの性能
  - リアルタイム画像処理
  - EXIF情報取得、GPS連携
  - ハードウェアエンコーダー活用
- **端末活用**: カメラハードウェア直接制御

### AI画像解析（ネイティブ + ハイブリッド）
**メイン: オンデバイスAI**
- **TensorFlow Lite Mobile**
  - ネイティブAI推論エンジン
  - GPU/NPU加速対応
  - 高速・低消費電力
  - 食べ物認識モデル組み込み
- **Core ML (iOS) / ML Kit (Android)**
  - OS標準のAI機能活用
  - テキスト認識、物体検出
  - ハードウェア最適化済み

**補完: クラウドAI（緊急時のみ）**
- **Google Gemini API**
  - 月1,500回無料枠
  - オンデバイスAIで不明な場合のみ使用
  - 月3-5回程度の想定

### バックアップ・同期
**選択: iCloud (iOS) / Google Drive (Android) + 暗号化**
- 理由:
  - OS標準機能で自動バックアップ
  - ユーザーの追加設定不要
  - 端末間同期も自動
- **端末活用**: OS標準の同期機能をそのまま活用

### 開発・配布
**選択: Expo Application Services (EAS)**
- 理由:
  - 個人開発者は月100回ビルド無料
  - App Store Connect/Google Play自動連携
  - OTA（Over The Air）アップデート対応
- **無料枠**: 個人利用は完全無料

## 無料枠での運用コスト試算

### 月間想定（個人利用）
- **写真解析**: 50枚/月
- **データベース**: 食事記録500件程度
- **画像ストレージ**: 100MB/月
- **サイト訪問**: 1,000PV/月

### サービス別コスト
| サービス | 無料枠 | 想定使用量 | コスト |
|---------|--------|------------|--------|
| Vercel | 100GB帯域幅 | ~1GB | **無料** |
| Supabase | 500MB DB + 1GB Storage | 50MB + 100MB | **無料** |
| Google Gemini | 1,500req/月 | 50req/月 | **無料** |
| OpenAI | $5クレジット | フォールバック用 | **無料** |
| Cloudinary | 25クレジット | 必要時のみ | **無料** |

**合計月額: 0円** 🎉

### 無料枠を超えた場合の移行戦略
1. **画像ストレージ**: Cloudinary無料枠 → R2/S3互換ストレージ
2. **AI解析**: 使用量に応じてOpenAI従量課金
3. **データベース**: Supabase Pro ($25/月)
4. **ホスティング**: Vercel Pro ($20/月)

### 開発・デプロイコスト
- **ドメイン**: Vercel提供サブドメイン（無料）
- **SSL証明書**: 自動提供（無料）
- **CI/CD**: GitHub Actions（月2,000分無料）
- **開発ツール**: Cursor（個人無料版）/ VS Code（無料）

## 開発環境
- **IDE**: Cursor (AI支援重視)
- **バージョン管理**: GitHub
- **パッケージ管理**: pnpm
- **CSS**: Tailwind CSS
- **UI コンポーネント**: shadcn/ui

## MVP機能仕様

### 必須機能
1. **写真撮影・アップロード**
   - カメラ連携
   - ファイル選択
   - 画像プレビュー

2. **AI解析・保存**
   - OpenAI Vision APIで解析
   - 料理名、材料、メモを抽出
   - Supabaseに保存

3. **記録一覧表示**
   - 日付別表示
   - サムネイル表示
   - 解析結果表示

4. **基本検索**
   - テキスト検索
   - 日付フィルター

### 将来拡張機能
- セマンティック検索（ベクトル検索）
- 栄養素情報表示
- 統計・レポート機能
- 位置情報連携

## 次のステップ
1. 環境セットアップ
2. データベース設計
3. 画面設計・ワイヤーフレーム
4. API設計