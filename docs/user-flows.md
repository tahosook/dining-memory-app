# Dining Memory App - ユーザーフロー設計

## プロジェクト概要

### アプリ概要
**Dining Memory App** - AI-powered dining memory app that analyzes food & drink photos

### ターゲットユーザー
- **年齢**: 40代後半男性
- **技術リテラシー**: 高い
- **ライフスタイル**: ビジネスパーソン、グルメ好き、ダイエット意識あり
- **求めるもの**: シンプルなUI、実用的な機能、データの安全性

### 解決する課題
- 食事写真を撮るが、後で見返すことが少ない
- クラウドストレージの容量を無駄に消費している
- 過去の美味しかった料理やお店を思い出せない
- 自分の食事パターンや行動習慣に気づけない

---

## 主要ユーザーフロー

### 1. 📸 メインフロー：食事記録

#### 基本フロー
```
[アプリ起動] → [CameraScreen] → [写真撮影] → [AI解析中] → [解析結果確認] → [編集（オプション）] → [保存完了]
                      ↓
              [ギャラリーから選択]
```

#### 詳細ステップ
1. **アプリ起動**
   - 起動画面（スプラッシュ）
   - CameraScreenが表示（カメラファースト設計）

2. **写真撮影**
   - カメラプレビュー表示
   - ワンタップ撮影
   - または、ギャラリーから既存写真選択

3. **AI解析処理**
   - 撮影画像をプレビュー表示
   - TensorFlow Liteでローカル解析（3-5秒）
   - プログレスバーで進捗表示
   - キャンセル・再撮影のオプション

4. **解析結果確認**
   - 料理名、材料、ジャンル表示
   - 確信度の表示（？マーク等）
   - 位置情報、時刻の自動取得表示

5. **編集（必要に応じて）**
   - 料理名の修正
   - メモの追加
   - 場所の修正
   - 材料の追加・削除

6. **保存完了**
   - データベースに保存
   - 成功フィードバック表示
   - 今日の記録件数等の表示
   - 「続けて撮影」または「記録を見る」選択

#### 例外フロー

**AI解析失敗時:**
```
[解析困難] → [手動入力モード] → [基本情報入力] → [保存]
     ↓
[クラウドAI提案] → [Yes: Gemini API] → [解析結果] → [保存]
                   [No: 手動入力継続]
```

**ネットワークエラー時:**
```
[クラウドAI失敗] → [ローカル結果使用] → [編集可能] → [保存]
```

### 2. 🔍 検索・振り返りフロー

#### 基本フロー
```
[SearchScreen] → [検索入力/フィルター選択] → [検索結果表示] → [記録詳細表示]
     ↓
[RecordsScreen] → [期間フィルター] → [一覧表示] → [記録詳細表示]
```

#### 検索パターン
1. **テキスト検索**
   - 検索バーに料理名入力「ラーメン」
   - リアルタイム候補表示
   - 検索結果一覧（ハイライト表示）

2. **期間フィルター**
   - 今日、今週、今月、先月
   - カスタム期間設定
   - 結果の日付別グループ表示

3. **場所フィルター**
   - よく行く場所一覧
   - 複数選択可能
   - 地図表示オプション

4. **複合検索**
   - テキスト + 期間 + 場所
   - AND条件での絞り込み
   - 結果件数の動的表示

#### 詳細表示フロー
```
[記録カード選択] → [詳細画面] → [編集] → [更新保存]
                            → [削除] → [確認] → [削除実行]
                            → [共有] → [共有オプション選択]
```

### 3. 📊 統計・インサイトフロー

#### 基本フロー
```
[StatsScreen] → [期間選択] → [統計表示] → [詳細分析] → [発見・インサイト]
```

#### 統計表示パターン
1. **サマリー表示**
   - 今月の記録数、前月比較
   - 自宅 vs 外食の比率
   - よく行く店舗
   - 最多の曜日

2. **自炊分析**
   - 時短料理 vs 日常料理 vs 本格料理
   - よく作る料理ランキング
   - 忘れかけてるメニュー発見
   - 料理への気分変化

3. **行動パターン発見**
   - 隠れたルーティン発見
   - 曜日別傾向
   - 天気・環境との関連
   - 時期比較での変化

#### インサイト表示フロー
```
[パターン発見] → [詳細説明] → [関連記録表示] → [アクション提案（控えめ）]
```

### 4. ⚙️ 設定・管理フロー

#### データ管理フロー
```
[SettingsScreen] → [データ管理] → [バックアップ] → [実行] → [完了確認]
                              → [エクスポート] → [形式選択] → [実行]
                              → [削除] → [確認画面] → [実行]
```

#### バックアップ・復元フロー
1. **自動バックアップ**
   - iCloud/Google Drive連携
   - 定期自動実行
   - 状況表示（最終バックアップ時刻）

2. **手動バックアップ**
   - 「今すぐバックアップ」ボタン
   - 進捗表示
   - 完了通知

3. **データ復元**
   - バックアップ一覧表示
   - 復元内容プレビュー
   - 確認後実行

#### 設定変更フロー
```
[設定項目] → [変更画面] → [設定変更] → [保存] → [反映確認]
```

---

## 40代男性を意識したUXフロー設計

### シンプル・直感的な操作
1. **最小タップ数**
   - 撮影→保存まで3タップ以内
   - よく使う機能への直接アクセス
   - 戻るボタンの明確配置

2. **大きなタップエリア**
   - メインボタンは80pt以上
   - 一般ボタンは44pt以上
   - 誤操作防止の適切な間隔

3. **明確なフィードバック**
   - 操作完了の視覚的確認
   - エラー時の分かりやすい説明
   - 進捗状況の明示

### 効率性重視のフロー
1. **情報の自動取得**
   - GPS位置情報の自動記録
   - 撮影時刻の自動記録
   - AI解析による自動入力

2. **学習・提案機能**
   - よく行く店のプリセット
   - 検索履歴の活用
   - 行動パターンの発見（押し付けがましくない）

3. **データの永続化**
   - 入力中データの自動保存
   - 操作中断時の状態復帰
   - データ損失防止

### 信頼性・安心感のあるフロー
1. **データの透明性**
   - 何がどこに保存されるかの明示
   - バックアップ状況の可視化
   - 削除前の十分な確認

2. **段階的フォールバック**
   ```
   ローカルAI解析 → クラウドAI → 手動入力
   ```
   - 各段階での選択権をユーザーに付与
   - 失敗時の代替手段を明確に提示

3. **プライバシー配慮**
   - データの端末内保存を明示
   - 外部送信時の明示的確認
   - いつでも削除可能

---

## エラーハンドリングフロー

### 技術的エラーの対応

#### カメラエラー
```
[カメラ起動失敗] → [権限確認] → [設定案内] → [再試行]
                            → [ギャラリー選択に誘導]
```

#### AI解析エラー
```
[ローカルAI失敗] → [クラウドAI提案] → [手動入力案内]
                               → [再撮影提案]
```

#### ストレージエラー
```
[容量不足] → [容量確認画面] → [不要データ削除案内] → [再試行]
```

#### ネットワークエラー
```
[通信失敗] → [オフライン継続提案] → [後で同期設定]
```

### ユーザーエラーの対応

#### 撮影失敗（ブレ、暗い等）
```
[品質チェック] → [再撮影提案] → [そのまま保存オプション]
```

#### 入力ミス
```
[保存前確認] → [編集に戻る] → [そのまま保存]
```

#### 削除の誤操作
```
[削除確認] → [復元可能期間告知] → [削除実行]
         → [キャンセル]
```

---

## アクセシビリティを考慮したフロー

### 視覚サポート
1. **大文字表示対応**
   - システム文字サイズに追従
   - レイアウトの動的調整
   - 重要情報の強調表示

2. **高コントラスト対応**
   - ダークモード対応
   - 色覚サポート
   - 明確な境界線

### 操作サポート
1. **VoiceOver/TalkBack対応**
   - 適切なアクセシビリティラベル
   - 操作ヒントの提供
   - 論理的な要素順序

2. **代替操作方法**
   - タップの長押し対応
   - スワイプジェスチャー
   - 物理ボタン対応

---

## パフォーマンスを意識したフロー

### 高速レスポンス
1. **段階的読み込み**
   - 画面表示→データ読み込み→詳細表示
   - プレースホルダーの活用
   - ローディング状態の明示

2. **キャッシュ活用**
   - よく見る画面の先読み
   - 検索結果のキャッシュ
   - サムネイル画像の事前生成

### メモリ効率
1. **画像の最適化**
   - 表示サイズに応じた解像度
   - 不要画像の解放
   - 遅延読み込み

2. **データベース最適化**
   - 必要なデータのみ読み込み
   - インデックスを活用した高速検索
   - バックグラウンド処理

---

## オンボーディングフロー

### 初回起動時
```
[スプラッシュ] → [ウェルカム画面] → [権限要求] → [簡単説明] → [最初の撮影案内]
```

#### 権限要求フロー
1. **カメラ権限**
   - 必要性の説明
   - 許可後の体験説明
   - 拒否時の代替手段

2. **位置情報権限**
   - オプション性の強調
   - 後からでも変更可能
   - プライバシー配慮の説明

#### チュートリアル
1. **最小限の説明**
   - 「撮影→記録→振り返り」の3ステップ
   - 実際の操作による体験
   - スキップ可能

2. **段階的学習**
   - 使いながら覚える方式
   - ツールチップでの補助説明
   - ヘルプへの容易なアクセス

---

## 継続利用を促すフロー

### 習慣化支援
1. **自然な継続**
   - 押し付けがましくない記録継続
   - 記録忘れの際の軽いリマインド
   - 継続状況の可視化（控えめ）

2. **発見の楽しみ**
   - 新しいパターンの発見
   - 「そういえば」的な気づき
   - 成長の実感（記録数、レパートリー増等）

### データ活用の実感
1. **実用的な振り返り**
   - 行動パターンの発見
   - よく行く店の再確認
   - 自炊レパートリーの整理

2. **価値の実感**
   - データが蓄積される喜び
   - 検索での発見体験
   - 記録を見返す楽しみ

---

## 将来拡張を考慮したフロー

### 機能追加時の対応
1. **段階的機能追加**
   - 既存フローを壊さない拡張
   - オプション機能としての提供
   - ユーザー選択による有効化

2. **データ移行**
   - 既存データの保護
   - 新機能への自然な誘導
   - 後方互換性の維持

### 他サービス連携
1. **外部アプリ連携**
   - レシピアプリとの連携
   - カレンダーアプリとの連携
   - ヘルスケアアプリとの連携

2. **データ共有**
   - 家族・友人との共有
   - SNS投稿機能
   - レビューサイト連携

---

## 品質保証のためのフロー確認

### テストシナリオ
1. **基本フロー**
   - 撮影→保存の正常系
   - 各エラーケースの異常系
   - データ復元・削除の確認

2. **境界値テスト**
   - 大量データでの動作
   - ストレージ容量限界での動作
   - ネットワーク不安定時の動作

3. **ユーザビリティテスト**
   - 40代男性による実際の使用
   - 直感的操作の確認
   - エラー時の理解度確認

---

*このユーザーフロー設計は、実装・テスト段階での発見に応じて随時更新・改善していく*